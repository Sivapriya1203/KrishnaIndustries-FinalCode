import{r as l,j as e,T as w,G as j,F as D,I as b,a7 as N,a5 as d,h as k,X as z,Y as $,Z as G,$ as H,a0 as C,a1 as s,a2 as O,ag as Q,c as W,d as U,ah as X}from"./index-14iq4arv.js";const V=()=>{const[y,F]=l.useState([]),[i,S]=l.useState([]),[I,T]=l.useState(!0),[h,M]=l.useState(""),[u,R]=l.useState(""),[f,p]=l.useState(0),[x,Y]=l.useState(10),[P,Z]=l.useState(!1),g=new Date().getFullYear();l.useEffect(()=>{(async()=>{try{const t=await W.get(`${U.apiUrl}/sales/salesReport`);F(t.data),S(t.data)}catch(t){console.error("Error fetching sales report:",t)}finally{T(!1)}})()},[]);const E=(a,t,c)=>a.filter(m=>{const n=new Date(m.invoice_date),r=t?n.getMonth()+1===parseInt(t):!0,B=c?n.getFullYear()===parseInt(c):!0;return r&&B}),L=()=>{let a=y;a=E(a,h,u),S(a),p(0)};l.useEffect(()=>{L()},[h,u,y]);const _=(a,t)=>{p(t)},q=a=>{Y(parseInt(a.target.value,10)),p(0)},A=()=>{const a=document.querySelectorAll(".no-print");a.forEach(n=>{n.style.display="none"});const t=new X("p","mm","a4");t.setFontSize(18),t.text("Sales Report",90,22);const c=[{header:"Serial No.",dataKey:"serialNo"},{header:"Leads Name",dataKey:"leadsName"},{header:"Product Name",dataKey:"productName"},{header:"Quantity",dataKey:"quantity"},{header:"Price",dataKey:"price"},{header:"Total Price",dataKey:"totalPrice"},{header:"Invoice Date",dataKey:"invoiceDate"}],m=v.map((n,r)=>({serialNo:o+r+1,leadsName:n.leads_name,productName:n.pro_name||"N/A",quantity:n.quantity,price:n.price,totalPrice:(n.price*n.quantity).toFixed(2),invoiceDate:new Date(n.invoice_date).toLocaleDateString()}));t.autoTable({columns:c,body:m,margin:{top:30},theme:"grid",headStyles:{fillColor:[255,0,0]},footStyles:{fillColor:[0,255,0]},didDrawPage:function(n){const r=t.internal.getNumberOfPages();t.setFontSize(10),t.text(`Page ${r}`,100,t.internal.pageSize.height-10)}}),t.save("Sales_Report.pdf"),a.forEach(n=>{n.style.display=""})};if(I)return e.jsx("div",{children:"Loading..."});const o=f*x,K=o+x,v=P?i:i.slice(o,K);return e.jsxs(e.Fragment,{children:[e.jsx(w,{variant:"h1",align:"center",marginTop:"20px",marginBottom:"40px",children:"Sales Report"}),e.jsxs(j,{container:!0,spacing:2,style:{marginBottom:"20px"},className:"no-print",children:[e.jsx(j,{item:!0,xs:6,children:e.jsxs(D,{variant:"outlined",fullWidth:!0,children:[e.jsx(b,{id:"month-select-label",children:"Select Month"}),e.jsxs(N,{labelId:"month-select-label",value:h,onChange:a=>M(a.target.value),label:"Select Month",children:[e.jsx(d,{value:"",children:e.jsx("em",{children:"All Months"})}),[...Array(12).keys()].map(a=>e.jsx(d,{value:a+1,children:new Date(0,a).toLocaleString("default",{month:"long"})},a+1))]})]})}),e.jsx(j,{item:!0,xs:6,children:e.jsxs(D,{variant:"outlined",fullWidth:!0,children:[e.jsx(b,{id:"year-select-label",children:"Select Year"}),e.jsxs(N,{labelId:"year-select-label",value:u,onChange:a=>R(a.target.value),label:"Select Year",children:[e.jsx(d,{value:"",children:e.jsx("em",{children:"All Years"})}),[...Array(10).keys()].map(a=>e.jsx(d,{value:g-a,children:g-a},g-a))]})]})})]}),e.jsx(k,{variant:"contained",color:"primary",onClick:A,style:{marginBottom:"20px",float:"right"},className:"no-print",children:"Downlode PDF"}),e.jsx(z,{component:$,className:"print-table",children:e.jsxs(G,{children:[e.jsx(H,{children:e.jsxs(C,{children:[e.jsx(s,{children:"Serial No."}),e.jsx(s,{children:"Leads Name"}),e.jsx(s,{children:"Product Name"}),e.jsx(s,{children:"Quantity"}),e.jsx(s,{children:"Price"}),e.jsx(s,{children:"Total Price"}),e.jsx(s,{children:"Invoice Date"})]})}),e.jsx(O,{children:v.map((a,t)=>e.jsxs(C,{children:[e.jsx(s,{children:o+t+1}),e.jsx(s,{children:a.leads_name}),e.jsx(s,{children:a.pro_name||"N/A"}),e.jsx(s,{children:a.quantity}),e.jsx(s,{children:a.price}),e.jsx(s,{children:(a.price*a.quantity).toFixed(2)}),e.jsx(s,{children:new Date(a.invoice_date).toLocaleDateString()})]},a.id))})]})}),!P&&e.jsx(Q,{rowsPerPageOptions:[10,20,50,100,i.length],component:"div",count:i.length,rowsPerPage:x,page:f,onPageChange:_,onRowsPerPageChange:q,className:"no-print"})]})};export{V as default};
