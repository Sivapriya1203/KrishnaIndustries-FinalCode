import{ab as se,r as n,c as ne,d as le,j as e,G as r,B as ie,h as j,a4 as _,F as re,a7 as oe,a5 as i,X as ce,Y as de,Z as he,$ as ue,a0 as F,a1 as s,a2 as xe,ac as me,S as je,U as pe,W as Ce,a3 as fe}from"./index-14iq4arv.js";import{h as b}from"./moment-G82_0lEo.js";import{T as ge,a as I,U as Se}from"./UpdateFlwLeads-l02mNBDA.js";import{P as ve}from"./Pagination-Drt3pWZO.js";const Pe=()=>{const M=se(),[d,A]=n.useState([]),[y,D]=n.useState(null),[p,P]=n.useState(null),[C,f]=n.useState([]),[h,T]=n.useState(5),[g,S]=n.useState(1),[W,B]=n.useState([]),[N,L]=n.useState([]),[o,w]=n.useState(""),[u,k]=n.useState(""),[c,U]=n.useState(""),O=sessionStorage.getItem("emp_id"),[x,$]=n.useState(1),[Y,m]=n.useState(!1),[z,Q]=n.useState([]);n.useEffect(()=>{ne.get(`${le.apiUrl}/customer/CustomerLeadsByEmpId?emp_id=${O}`).then(t=>{const a=new Set(t.data.map(l=>l.leads_state));B([...a]),A(t.data),f(t.data)}).catch(t=>{console.log("Leads data is not fetched.",t)})},[Y]),n.useEffect(()=>{if(o){const t=new Set(d.filter(a=>a.leads_state===o).map(a=>a.leads_city));L([...t])}else L([])},[o]),n.useEffect(()=>{const t=b().format("YYYY-MM-DD"),a=d.filter(l=>{const K=c===""||l.leads_name.toLowerCase().includes(c.toLowerCase())||l.leads_name.toUpperCase().includes(c.toUpperCase)||l.leads_email.toLowerCase().includes(c.toLowerCase())||l.leads_email.toUpperCase().includes(c.toUpperCase())||l.leads_mobile.includes(c),ee=o===""||l.leads_state===o,te=u===""||l.leads_city===u,ae=x===1||x===2&&b(l.created_at).format("YYYY-MM-DD")===t;return K&&ee&&te&&ae});f(a)},[c,o,u,x,d]);const R=t=>{const a=parseInt(t.target.value,10);a==1?(T(d.length),S(1)):(T(a),S(1))},G=(g-1)*h,V=g*h,q=C?C.slice(G,V):[],H=()=>{w(""),k(""),U(""),f(d)},X=t=>{const a=d.find(l=>l.follow_id===t);a&&(Q(a),m(!0))},Z=(t,a)=>{D(t.currentTarget),P(a)},E=()=>{D(null),P(null)},v=(t,a)=>{E(),M(`/${t}/${a}`)},J=!!y;return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Customer Index"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:8,children:e.jsx(ie,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(ge,{value:x,onChange:(t,a)=>$(a),centered:!0,children:[e.jsx(I,{label:"All Leads",value:1}),e.jsx(I,{label:"Today's Leads",value:2})]})})}),e.jsx(r,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(j,{variant:"outlined",onClick:H,children:"Cancel Filters"})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsx(_,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:t=>U(t.target.value),value:c})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(re,{fullWidth:!0,children:e.jsxs(oe,{value:h,onChange:R,children:[e.jsx(i,{value:5,children:"5 Per Page"}),e.jsx(i,{value:10,children:"10 Per Page"}),e.jsx(i,{value:15,children:"15 Per Page"}),e.jsx(i,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsxs(_,{fullWidth:!0,select:!0,label:"Select State",value:o,onChange:t=>w(t.target.value),children:[e.jsx(i,{value:"",children:"All States"}),W.map((t,a)=>e.jsx(i,{value:t,children:t},a))]})}),e.jsx(r,{item:!0,xs:6,children:e.jsxs(_,{fullWidth:!0,select:!0,label:"Select City",value:u,onChange:t=>k(t.target.value),disabled:!o,children:[e.jsx(i,{value:"",children:"All Cities"}),N.map((t,a)=>e.jsx(i,{value:t,children:t},a))]})})]}),e.jsx(ce,{component:de,style:{marginTop:"20px"},children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(F,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(s,{children:"S.No"}),e.jsx(s,{children:"Employee Name"}),e.jsx(s,{children:"Leads Name"}),e.jsx(s,{children:"Leads Mobile"}),e.jsx(s,{children:"Leads Email"}),e.jsx(s,{children:"Leads Company"}),e.jsx(s,{children:"State"}),e.jsx(s,{children:"City"}),e.jsx(s,{children:"Reminder Date"}),e.jsx(s,{children:"Action"})]})}),e.jsx(xe,{children:q.map((t,a)=>e.jsxs(F,{children:[e.jsx(s,{children:a+1}),e.jsx(s,{children:t.emp_name}),e.jsx(s,{children:t.leads_name}),e.jsx(s,{children:t.leads_mobile}),e.jsx(s,{children:t.leads_email}),e.jsx(s,{children:t.leads_company}),e.jsx(s,{children:t.leads_state}),e.jsx(s,{children:t.leads_city}),e.jsx(s,{children:b(t.reminder_date).format("YYYY-MM-DD")}),e.jsxs(s,{children:[e.jsx(j,{variant:"outlined",onClick:l=>Z(l,t),children:"Quotation"}),e.jsxs(me,{open:J&&(p==null?void 0:p.follow_id)===t.follow_id,anchorEl:y,onClose:E,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(i,{onClick:()=>v("quotation",t.follow_id),children:"Quotation"}),e.jsx(i,{onClick:()=>v("proforma",t.follow_id),children:"Proforma"}),e.jsx(i,{onClick:()=>v("invoice",t.follow_id),children:"Invoice"})]}),e.jsx(j,{onClick:()=>X(t.follow_id),children:"Edit"})]})]},a))})]})}),e.jsx(r,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(je,{spacing:2,children:e.jsx(ve,{count:Math.ceil(C.length/h),page:g,onChange:(t,a)=>S(a),size:"small"})})}),e.jsxs(pe,{open:Y,onClose:()=>m(!1),maxWidth:"md",children:[e.jsx(Ce,{children:e.jsx(Se,{data:z,onClose:()=>m(!1)})}),e.jsx(fe,{children:e.jsx(j,{onClick:()=>m(!1),children:"Close"})})]})]})};export{Pe as default};
