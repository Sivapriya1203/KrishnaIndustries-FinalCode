import{ab as he,r as s,c as pe,d as ue,j as e,G as r,B as me,h as p,a4 as E,F as je,a7 as fe,a5 as o,X as ge,Y as Ce,Z as be,$ as ye,a0 as I,a1 as n,a2 as Se,ac as _e,S as ve,U as De,W as we,a3 as Le}from"./index-14iq4arv.js";import{h as b}from"./moment-G82_0lEo.js";import{T as Pe,a as B,U as Te}from"./UpdateFlwLeads-l02mNBDA.js";import{P as Ee}from"./Pagination-Drt3pWZO.js";const Ae=()=>{const O=he(),[x,$]=s.useState([]),[k,Y]=s.useState(null),[y,U]=s.useState(null),[S,_]=s.useState([]),[u,F]=s.useState(5),[v,D]=s.useState(1),[Q,V]=s.useState([]),[G,A]=s.useState([]),[d,R]=s.useState(""),[m,W]=s.useState(""),[c,M]=s.useState("");sessionStorage.getItem("emp_id");const[j,q]=s.useState(1),[N,f]=s.useState(!1),[H,X]=s.useState([]);s.useState(!1),s.useState([]),s.useState(!1),s.useState([]);const[w,Z]=s.useState(""),[L,J]=s.useState(""),[P,K]=s.useState("");s.useEffect(()=>{pe.get(`${ue.apiUrl}/leads/empFollowLeadsForAdmin`).then(t=>{const a=new Set(t.data.map(l=>l.leads_state));V([...a]),$(t.data),_(t.data)}).catch(t=>{console.log("Leads data is not fetched.",t)})},[N]),s.useEffect(()=>{if(d){const t=new Set(x.filter(a=>a.leads_state===d).map(a=>a.leads_city));A([...t])}else A([])},[d]),s.useEffect(()=>{const t=b().format("YYYY-MM-DD"),a=x.filter(l=>{const i=c===""||l.leads_name.toLowerCase().includes(c.toLowerCase())||l.leads_name.toUpperCase().includes(c.toUpperCase)||l.leads_email.toLowerCase().includes(c.toLowerCase())||l.leads_email.toUpperCase().includes(c.toUpperCase())||l.leads_mobile.includes(c),h=d===""||l.leads_state===d,g=m===""||l.leads_city===m,C=j===1||j===2&&b(l.created_at).format("YYYY-MM-DD")===t;return i&&h&&g&&C});_(a)},[c,d,m,j,x]);const ee=t=>{const a=parseInt(t.target.value,10);a==1?(F(x.length),D(1)):(F(a),D(1))},te=(v-1)*u,ae=v*u,se=S?S.slice(te,ae):[],ne=()=>{R(""),W(""),M(""),_(x)},le=t=>{const a=x.find(l=>l.follow_id===t);a&&(X(a),f(!0))},oe=(t,a)=>{Y(t.currentTarget),U(a)},z=()=>{Y(null),U(null)},T=(t,a)=>{z(),O(`/${t}/${a}`)},re=!!k,ie=()=>{const t=x.filter(g=>{const C=b(g.created_at).format("YYYY-MM-DD"),ce=(!w||C>=w)&&(!L||C<=L),xe=!P||g.emp_name.toLowerCase().includes(P.toLowerCase());return ce&&xe}),a=de(t),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),h=URL.createObjectURL(l);i.href=h,i.setAttribute("download","filtered_employee_data.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},de=t=>{const a=["follow_id","emp_id","emp_name","leads_id","leads_name","leads_mobile","leads_email","product_name","leads_company","Description","Call_Discussion","remember","reminder_date","leads_address","leads_state","leads_city","call_Attended","gst_number","created_at"],l=t.map(i=>a.map(h=>i[h]||"").join(","));return`${a.join(",")}
${l.join(`
`)}`};return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Followed Leads Index"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:8,children:e.jsx(me,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(Pe,{value:j,onChange:(t,a)=>q(a),centered:!0,children:[e.jsx(B,{label:"All Leads",value:1}),e.jsx(B,{label:"Today's Leads",value:2})]})})}),e.jsx(r,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(p,{variant:"outlined",onClick:ne,children:"Cancel Filters"})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:t=>M(t.target.value),value:c})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(je,{fullWidth:!0,children:e.jsxs(fe,{value:u,onChange:ee,children:[e.jsx(o,{value:5,children:"5 Per Page"}),e.jsx(o,{value:10,children:"10 Per Page"}),e.jsx(o,{value:15,children:"15 Per Page"}),e.jsx(o,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsxs(E,{fullWidth:!0,select:!0,label:"Select State",value:d,onChange:t=>R(t.target.value),children:[e.jsx(o,{value:"",children:"All States"}),Q.map((t,a)=>e.jsx(o,{value:t,children:t},a))]})}),e.jsx(r,{item:!0,xs:6,children:e.jsxs(E,{fullWidth:!0,select:!0,label:"Select City",value:m,onChange:t=>W(t.target.value),disabled:!d,children:[e.jsx(o,{value:"",children:"All Cities"}),G.map((t,a)=>e.jsx(o,{value:t,children:t},a))]})})]}),e.jsxs("div",{style:{padding:"20px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[e.jsx("h3",{style:{textAlign:"center",padding:"10px",color:"red"},children:"Download Employee Reports"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"15px",justifyContent:"center"},children:[e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"Employee Name:"}),e.jsx("input",{type:"text",value:P,onChange:t=>K(t.target.value),placeholder:"Enter employee name",style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}}),e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"Start Date:"}),e.jsx("input",{type:"date",value:w,onChange:t=>Z(t.target.value),style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}}),e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"End Date:"}),e.jsx("input",{type:"date",value:L,onChange:t=>J(t.target.value),style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsx(p,{variant:"contained",color:"primary",onClick:ie,style:{padding:"10px 20px",fontWeight:"bold",borderRadius:"6px",backgroundColor:"#007bff",color:"#fff"},children:"Download Employee Data"})})]}),e.jsx(ge,{component:Ce,style:{marginTop:"20px"},children:e.jsxs(be,{children:[e.jsx(ye,{children:e.jsxs(I,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(n,{children:"S.No"}),e.jsx(n,{children:"Employee Name"}),e.jsx(n,{children:"Leads Name"}),e.jsx(n,{children:"Leads Mobile"}),e.jsx(n,{children:"Leads Email"}),e.jsx(n,{children:"Leads Company"}),e.jsx(n,{children:"State"}),e.jsx(n,{children:"City"}),e.jsx(n,{children:"Reminder Date"}),e.jsx(n,{children:"Action"})]})}),e.jsx(Se,{children:se.map((t,a)=>e.jsxs(I,{children:[e.jsx(n,{children:a+1}),e.jsx(n,{children:t.emp_name}),e.jsx(n,{children:t.leads_name}),e.jsx(n,{children:t.leads_mobile}),e.jsx(n,{children:t.leads_email}),e.jsx(n,{children:t.leads_company}),e.jsx(n,{children:t.leads_state}),e.jsx(n,{children:t.leads_city}),e.jsx(n,{children:b(t.reminder_date).format("YYYY-MM-DD")}),e.jsxs(n,{children:[e.jsx(p,{variant:"outlined",onClick:l=>oe(l,t),children:"Quotation"}),e.jsxs(_e,{open:re&&(y==null?void 0:y.follow_id)===t.follow_id,anchorEl:k,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(o,{onClick:()=>T("quotation",t.follow_id),children:"Quotation"}),e.jsx(o,{onClick:()=>T("proforma",t.follow_id),children:"Proforma"}),e.jsx(o,{onClick:()=>T("invoice",t.follow_id),children:"Invoice"})]}),e.jsx(p,{onClick:()=>le(t.follow_id),children:"Edit"})]})]},a))})]})}),e.jsx(r,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(ve,{spacing:2,children:e.jsx(Ee,{count:Math.ceil(S.length/u),page:v,onChange:(t,a)=>D(a),size:"small"})})}),e.jsxs(De,{open:N,onClose:()=>f(!1),maxWidth:"md",children:[e.jsx(we,{children:e.jsx(Te,{data:H,onClose:()=>f(!1)})}),e.jsx(Le,{children:e.jsx(p,{onClick:()=>f(!1),children:"Close"})})]})]})};export{Ae as default};
