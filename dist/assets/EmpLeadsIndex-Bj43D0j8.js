import{r as a,c as A,d as W,j as e,H as re,G as S,h as f,F as ie,a7 as ce,a5 as de,X as he,Y as xe,Z as fe,$ as ge,a0 as C,a1 as t,a2 as je,S as Ee,a6 as ue,a9 as me,U as P,V as k,W as v,a3 as F,s as Se,aa as De}from"./index-14iq4arv.js";import{h as D}from"./moment-G82_0lEo.js";import{S as pe}from"./Search-D10Vqw1G.js";import{A as ye}from"./AddFollowingLeads-DoFWmeGb.js";import{C as be}from"./ConvertCustomer-BHykrH44.js";import{P as _e}from"./Pagination-Drt3pWZO.js";const Ie=De(c=>({tableContainer:{maxHeight:"600px"},stickyAction:{position:"sticky",right:0,justifyItems:"center",alignItems:"center",backgroundColor:"#fff",zIndex:1},actionColumnHeader:{position:"sticky",right:0,alignItems:"center",justifyContent:"center",zIndex:2}})),Ce=c=>{const o=new Date(c),g=o.getDate().toString().padStart(2,"0"),d=(o.getMonth()+1).toString().padStart(2,"0"),p=o.getFullYear();let l=o.getHours();const U=o.getMinutes().toString().padStart(2,"0"),y=l>=12?"PM":"AM";l=l%12,l=l||12;const h=l.toString().padStart(2,"0");return`${g}/${d}/${p} ${h}:${U} ${y}`},Te=()=>{const c=Ie(),[o,g]=a.useState([]),[d,p]=a.useState([]),[l,U]=a.useState([]),[y,h]=a.useState(!1),[O,j]=a.useState(!1),[R,Y]=a.useState(""),[N,H]=a.useState("success"),[E,$]=a.useState(5),[b,L]=a.useState(1),[_,x]=a.useState([]),[B,u]=a.useState(!1),[m,G]=a.useState(),[V,M]=a.useState(!1),[q,Ue]=a.useState([]),[I,z]=a.useState(!0),[X,Z]=a.useState([]);a.useEffect(()=>{h(!0),J(),K()},[]);const J=()=>{A.get(`${W.apiUrl}/leads/getleads`).then(s=>{if(s.data.data.length>0){const n=s.data.data.sort((r,Q)=>new Date(Q.QUERY_TIME)-new Date(r.QUERY_TIME));g(n)}h(!1)}).catch(s=>{Y("An error occurred while fetching leads data."),j(!0),h(!1)})},K=()=>{A.get(`${W.apiUrl}/leads/getFollowingLeadsMobile`).then(s=>{p(s.data),console.log(s.data)}).catch(s=>{console.log("Error: Couldn't fetch following leads data.")})};a.useEffect(()=>{if(o.length>0&&d.length>0){const s=d.map(i=>i.leads_id),n=o.filter(i=>!s.includes(i.UNIQUE_QUERY_ID)),r=D().format("YYYY-MM-DD"),oe=n.filter(i=>D(i.QUERY_TIME).format("YYYY-MM-DD")===r).sort((i,le)=>new Date(le.QUERY_TIME)-new Date(i.QUERY_TIME));x(oe)}},[o,d]);const ee=()=>{if(I)x(l);else{const s=D().format("YYYY-MM-DD"),n=l.filter(r=>D(r.QUERY_TIME).format("YYYY-MM-DD")===s);x(n)}z(!I),L(1)},w=(b-1)*E,te=b*E,T=_.slice(w,te),se=s=>{if(o.length>0){const n=o.find(r=>r.UNIQUE_QUERY_ID===s);n&&(G(n),u(!0))}},ae=()=>{u(!1),Z([...X,m]);const s=o.filter(r=>r.UNIQUE_QUERY_ID!==m.UNIQUE_QUERY_ID);g(s);const n=_.filter(r=>r.UNIQUE_QUERY_ID!==m.UNIQUE_QUERY_ID);x(n),H("success"),Y("Lead followed successfully!"),j(!0)},ne=()=>{j(!1)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-center",children:"Leads Index"}),y?e.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[e.jsx(re,{}),e.jsx("p",{children:"Processing... Please wait."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(S,{item:!0,xs:3,children:e.jsx(pe,{data:l,setData:x})}),e.jsx(S,{item:!0,xs:3,children:e.jsx(f,{variant:"contained",onClick:ee,children:I?"Show All Unfollowed Leads":"Show Today Unfollowed Leads"})}),e.jsx(S,{item:!0,xs:3,children:e.jsx(ie,{children:e.jsx(ce,{value:E,onChange:s=>$(s.target.value),children:[5,10,15,20].map(s=>e.jsxs(de,{value:s,children:[s," per page"]},s))})})})]}),e.jsx(he,{component:xe,style:{marginTop:"20px"},children:e.jsxs(fe,{children:[e.jsx(ge,{children:e.jsxs(C,{children:[e.jsx(t,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Unique Query ID"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Query Type"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Query Time"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Name"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Mobile No"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Email"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Company Name"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(t,{style:{fontWeight:"bold"},children:"City"}),e.jsx(t,{style:{fontWeight:"bold"},children:"State"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Pincode"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Country ISO"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Mobile Alt"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Phone"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Phone Alt"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Email Alt"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Message"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Category Name"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Call Duration"}),e.jsx(t,{style:{fontWeight:"bold"},children:"Receiver Mobile"}),e.jsx(t,{className:c.actionColumnHeader,children:"Actions"})]})}),e.jsx(je,{children:T.length>0?T.map((s,n)=>e.jsxs(C,{children:[e.jsx(t,{children:n+1+w}),e.jsx(t,{children:s.UNIQUE_QUERY_ID}),e.jsx(t,{children:s.QUERY_TYPE}),e.jsx(t,{children:Ce(s.QUERY_TIME)}),e.jsx(t,{children:s.SENDER_NAME}),e.jsx(t,{children:s.SENDER_MOBILE}),e.jsx(t,{children:s.SENDER_EMAIL}),e.jsx(t,{children:s.SENDER_COMPANY}),e.jsx(t,{children:s.SENDER_ADDRESS}),e.jsx(t,{children:s.SENDER_CITY}),e.jsx(t,{children:s.SENDER_STATE}),e.jsx(t,{children:s.SENDER_PINCODE}),e.jsx(t,{children:s.SENDER_COUNTRY_ISO}),e.jsx(t,{children:s.SENDER_MOBILE_ALT}),e.jsx(t,{children:s.SENDER_PHONE}),e.jsx(t,{children:s.SENDER_PHONE_ALT}),e.jsx(t,{children:s.SENDER_EMAIL_ALT}),e.jsx(t,{children:s.QUERY_PRODUCT_NAME}),e.jsx(t,{children:s.QUERY_MESSAGE}),e.jsx(t,{children:s.QUERY_MCAT_NAME}),e.jsx(t,{children:s.CALL_DURATION}),e.jsx(t,{children:s.RECEIVER_MOBILE}),e.jsx(t,{className:c.stickyAction,children:e.jsx(f,{onClick:()=>se(s.UNIQUE_QUERY_ID),children:"Follow"})})]},s.UNIQUE_QUERY_ID)):e.jsx(C,{children:e.jsx(t,{colSpan:23,style:{textAlign:"center"},children:"No leads found."})})})]})}),e.jsx(Ee,{spacing:2,style:{marginTop:"20px"},children:e.jsx(_e,{count:Math.ceil(_.length/E),page:b,onChange:(s,n)=>L(n),variant:"outlined",shape:"rounded",color:"primary"})})]}),e.jsx(ue,{open:O,autoHideDuration:6e3,onClose:()=>j(!1),message:R,severity:N,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(me,{onClose:ne,severity:N,sx:{width:"100%"},children:R})}),e.jsxs(P,{open:B,onClose:()=>u(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(k,{children:"Follow Lead"}),e.jsx(v,{children:e.jsx(ye,{leadData:m,onSuccess:ae})}),e.jsx(F,{children:e.jsx(f,{onClick:()=>u(!1),color:"primary",children:"Cancel"})})]}),e.jsxs(P,{open:V,onClose:()=>M(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(k,{children:"Convert Lead to Customer"}),e.jsx(v,{children:e.jsx(be,{leadData:q})}),e.jsx(F,{children:e.jsx(f,{onClick:()=>M(!1),color:"primary",children:"Cancel"})})]})]})};Se(f)(({theme:c})=>({backgroundColor:"#3f51b5",color:"#ffffff",borderRadius:"8px",padding:"10px 20px",textTransform:"none",boxShadow:"0 3px 5px 2px rgba(63, 81, 181, .3)","&:hover":{backgroundColor:"#303f9f",boxShadow:"0 6px 8px 3px rgba(63, 81, 181, .3)"}}));export{Te as default};
